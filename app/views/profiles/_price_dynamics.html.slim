p=t :price_dynamics
- price_data = user.history.collect(&:price).select { |x| x > 0 } + [user.share_price || 0]
- if price_data.size < 2
  - price_data = price_data*2 

- initial_price_value = price_data[0]
- data = []
- price_data.each do |d|
  - data += [d - initial_price_value + 1]

- lc = GoogleChart::LineChart.new(size, "", false)
- lc.show_legend = false
- lc.data "price", data, '51c1ee'
= image_tag lc.to_url